<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="javascripts/jquery-ui-1.11.1.custom/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="stylesheets/main.css">
<link rel="stylesheet" type="text/css" href="stylesheets/questionbox.css">
<link rel="stylesheet" type="text/css" href="stylesheets/multiple.css">
<style type="text/css">
.ondo {
	display:none;
	background-color:lightgray;
	color:gray;
}
.ondo input{
	color:gray;
}

#showOndo {
	width:30px;
	height:30px;
}
#buyYear {
	width:86.1%;
	margin: 5px 8.4% 0 5.5%;
}

</style>
</head>
<body>
<script src="javascripts/googleAnalytics.js"></script>
<div id="banner">
	<span id="title">丟丟買屋時機計算網</span><br/>
	<span id="intro">何時購買房子，才能兼顧生活品質及經濟狀況？</span>
</div>
<div id="basicData">
<pre>
1.目前年齡<input class="year" id="copy-age" />
2.月薪<input class="money" id="copy-salary" /> x 薪水月數<input class="month" id="salaryMonth"/> = 年薪<input class="money" id="yearSalary"/>
3.當前月租<input class="money" id="rentCost"/>/月
4.目標房價<input class="money" id="houseCost"/>
</pre>
</div>

<!--租屋資產變化-->
<!--
<div id="highchartContent-rent">
</div>-->
<!--最佳買屋時機圖-->
<div id="highchartContent-best">
</div>
<hr/>
<!--買屋資產變化-->
<div id="highchartContent-house">
</div>
<div id="buyYear"></div>
<div style="text-align:center;margin-top:3px;">預計幾歲買屋？(調整上方拉bar可查看不同年紀買房時的資產變化)</div>
<!--租屋買屋資產比較圖-->
<!--
<div id="highchartContent-compare">
</div>-->

<br/>
<div id="inputTabs">
	<ul>
		<li><a href="#tabs-1">個人</a></li>
		<li><a href="#tabs-2">工作</a></li>
		<li><a href="#tabs-3">收支</a></li>
		<li><a href="#tabs-4">可租房產</a></li>
		<li><a href="#tabs-5">可購房產</a></li>
		<li><a href="#tabs-6">外在環境</a></li>
	</ul>
	<div id="tabs-1">
		<pre>
	現在年齡:<input class="year" id="age" value="30"/>
	預期壽命:<input class="year" id="life" value="86"/>
		</pre>
	</div>
	<div id="tabs-2">
		<pre>
	<div class="work multiple">
		薪水：<input class="money" id="salary" value="42000"/>/月
		年終：<input class="month" id="bonus"  value="1.5">月
		調薪幅度(年)：<input class="percentage" id="salaryAdjust" value="3">%/年 <span style="color:rgb(200,57,57);">=</span> 退休時年薪：<input class="money" id="finalYearSalary"/>
		預期退休年齡：<input class="year" id="retireAge" value="65"/>
		退休金：一次領<input class="money" id="retirementPayOnce" value="0"/> <span style="color:rgb(200,57,57);">+</span> 月領<input class="money" id="retirementPayMonthly" value="0"/>
		<div class="ondo">
		每日工時(不含通勤)：<input class="hour" id="workHourPerDay" value="9"/>小時
		週休<input class="day" id="restPerWeek" value="2"/>日 + 月休<input class="day" id="restPerMonth" value="0"/>日 + 年休<input class="day" id="restPerYear" value="10"/>日
		</div>
	</div>
		</pre>
	</div>
	<div id="tabs-3">
		<pre>
	現有資金:<input class="money" id="cash" value="500000"/>
	支出(不含住宿/工作通勤)：<input class="money" id="outgoing" value="20000"/> /月
	閒錢投資年報酬率：<input class="percentage" id="invest" value="1.3"/>%
	<div class="ondo">
		套用：定存年利率(%)     1.3
	</div>
	最低手頭現金額度：<input class="money" id="saveMoney" value="100000" />元
		(現金 - 最低現金額度 = 可投資金額/頭期款)
	<div class="ondo">
		也可考慮用百分比作設定
	是否有額外支出(多筆)
		時間/金額
	</div>
		</pre>
	</div>
	<div id="tabs-4">
		<pre>
<div id="rent" class="multiple">
	月租：<input class="money cost" value="6000"/>
	預期月租漲幅：<input class="percentage priceChange" value="1.5" /> %/年
	<div class="ondo">
	通勤時間(分/日)：<input class="minite" id="transTime" value="60"/>
<div id="rent" class="multiple">
	月租：<input class="money cost" value="6000"/>
	預期月租漲幅：<input class="percentage priceChange" value="1.5" /> %/年
	<div class="ondo">
	通勤時間(分/日)：<input class="minite" id="transTime" value="60"/>
	通勤支出(日)：<input class="money" id="transCost" value="100"/>
	</div>
</div>
		</pre>
	</div>
	<div id="tabs-5">
		<pre>
<div id="house" class="multiple">
	目標房價(現值)：<input class="money cost" value="8000000" /> 元
	預期房價漲幅：<input class="percentage priceChange" value="1.6" /> %/年
	<div class="ondo">
	持屋每年額外成本(%)     0.5
	</div>
	貸款年利率：<input class="percentage loanRatePerYear" value="3"/> % / 年
	<div class="ondo">
	通勤時間(分/日)：<input class="minite" id="transTime" value="60"/>
	通勤支出(日)：<input class="money" id="transCost" value="100"/>
	</div>
	願付多少月租入住：<input class="money equalRent" value="8000"/>
</div>
		</pre>
	</div>
	<div id="tabs-6">
	<pre>
	物價指數漲幅:<input class="percentage" id="priceIndex" value="1.5"/>% / 年
	</pre>
	</div>
</div>

顯示未完成功能<input type="checkbox" id="showOndo" />


</body>

<script src="javascripts/jquery-2.1.1.min.js"></script>
<script src="javascripts/jquery-ui-1.11.1.custom/jquery-ui.min.js"></script>

<script src="javascripts/highchart/highcharts.js"></script>
<script src="javascripts/highchart/modules/exporting.js"></script>

<script src="javascripts/questionbox.js"></script>
<script src="javascripts/multiple.js"></script>
<script src="javascripts/highchart.js"></script>
<script src="javascripts/countProperty.js"></script>
<script type="text/javascript">
function countYearSalary(){
	$("#yearSalary").val($("#copy-salary").val()*$("#salaryMonth").val());
}

function setBasicData(){
	$("#copy-age").val($("#age").val());
	$("#copy-salary").val($("#salary").val());
	$("#salaryMonth").val(parseFloat($("#bonus").val())+12);
	countYearSalary();
	$("#copy-salary, #salaryMonth").change(countYearSalary);
	$("#yearSalary").change(function(){
		$("#copy-salary").val(Math.round($("#yearSalary").val()/$("#salaryMonth").val()));
	});
	$("#rentCost").val($("#rent .cost").val());
	$("#houseCost").val($("#house .cost").val());
}

function copyBasicData(){
	$("#age").val($("#copy-age").val());
	$("#salary").val($("#copy-salary").val());
	$("#bonus").val(parseFloat($("#salaryMonth").val())-12);
	$("#rent .cost").val($("#rentCost").val());
	$("#house .cost").val($("#houseCost").val());
	countProperty();
}

function getWorkData(){
	age             = parseInt($("#age").val());//當前年齡
        retireAge       = $("#retireAge").val();//退休年齡
        salary          = parseInt($("#salary").val());//月薪
        bonus           = parseFloat($("#bonus").val());//年終
}

function countFinalSalary(){
	getWorkData();
        salaryAdjust    = 1+$("#salaryAdjust").val()/100;//調薪
	$("#finalYearSalary").val(Math.round(salary * (12+bonus) * Math.pow( salaryAdjust, retireAge - age)));
}

function countSalaryAdjust(){
	getWorkData();
	var finalYearSalary = $("#finalYearSalary").val();
	$("#salaryAdjust").val(Math.round((Math.pow(finalYearSalary / (salary * (12+bonus)), 1/(retireAge - age))-1)*100000)/1000);
}

$(function(){

	//設定未完成功能樣式
	$(".ondo :input").attr("disabled","disabled");
	$("#showOndo").change(function(){
		$(".ondo").toggle();
	});

	//設定初始資料
	setBasicData();
	$("#basicData").dialog({
		title:"基本資料",
		width:"auto",
		close: copyBasicData
	});

	//設定分頁
	$("#inputTabs").tabs();

	//設定基本輸入欄位
	$("input").css("text-align","right");
	$("input.money").attr("size","10");
	$("input.day").attr("size","3");
	$("input.month").attr("size","4");
	$("input.year").attr("size","3");
	$("input.percentage").attr("size","5");

	//自動計算預期壽命
	$("#age").change(function(){
		var age = parseInt($(this).val());
		if($(this).val()>0)
			$("#life").val(Math.ceil(Math.max(80+age/5,age+10)));
	});

	//自動計算最終年薪/調薪
	countFinalSalary();
	$("#finalYearSalary").change(countSalaryAdjust);
	$("#salaryAdjust").change(countFinalSalary);

	//買房年紀拉bar
	$("#waitYear").slider();
	countProperty();
	$("input").not("#basicData input").change(countProperty);

        $('#container').highcharts({});


});
</script>
</html>

